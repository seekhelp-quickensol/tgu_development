<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed'); class Library_controller extends CI_Controller { 	public function __construct(){		parent::__construct();		$this->is_logged();	}	public function is_logged(){		if($this->session->userdata('admin_id') == ""){			redirect('erp-access');		}	}	public function add_library(){	    $this->form_validation->set_rules('course','course','required');	    if($this->form_validation->run() === FALSE){	        $data['course'] = $this->Course_model->get_active_course();	        $data['single'] = $this->Library_model->get_single_ebook();	        	        $data['stream'] = array();	        $data['subject'] = array();	        if(!empty($data['single'])){	            $data['stream'] = $this->Library_model->get_course_stream($data['single']->course);	            $data['subject'] = $this->Library_model->get_course_stream_subject($data['single']->course,$data['single']->stream,$data['single']->year_sem);	        }	        $this->load->view('admin/add_library',$data);	    }else{	        $ebook ='';			if(isset($_FILES['userfile']) && $_FILES['userfile']['name'] != ""){				$ebook = $this->Digitalocean_model->upload_photo($filename="userfile",$path="images/ebook/");    			/*$config = array(    				'upload_path' 	=> "images/ebook",    				'allowed_types' => "*",    				'encrypt_name'	=> true,    			);			    			$this->upload->initialize($config);    			if($this->upload->do_upload('userfile')){    				$data = $this->upload->data();				    				$ebook = $data['file_name'];    					    			}else{    				$error = array('error' => $this->upload->display_errors());	    				$this->upload->display_errors();    			}*/			}      	        $result = $this->Library_model->set_library($ebook);	        if($result == 0){	            $this->session->set_flashdata('success','Book uploaded successfully!');	        }else{	            $this->session->set_flashdata('success','Book uploaded successfully!');	        }	        redirect('add_library');	    }	}	public function library_list(){		// $data['document'] = $this->Library_model->get_all_e_library_list_ajax();			$data['course'] = $this->Course_model->get_active_course();	        $data['single'] = $this->Library_model->get_single_ebook();				        $data['stream'] = array();	        $data['subject'] = array();	        if(!empty($data['single'])){	            $data['stream'] = $this->Library_model->get_course_stream($data['single']->course);	            $data['subject'] = $this->Library_model->get_course_stream_subject($data['single']->course,$data['single']->stream,$data['single']->year_sem);	        }		    $this->load->view('admin/library_list',$data);	}	public function course_library_list(){	    $this->load->view('admin/course_library_list');	}	public function count_library_list(){	    $this->load->view('admin/count_library_list');	}		public function stream_library_list(){	    $this->load->view('admin/stream_library_list');	}	public function year_sem_library_list(){	    $this->load->view('admin/year_sem_library_list');	}	public function subject_library_list(){	    $this->load->view('admin/subject_library_list');	}	public function book_library_list(){	    $this->load->view('admin/book_library_list');	}		}	