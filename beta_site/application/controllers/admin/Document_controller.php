<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed'); class Document_controller extends CI_Controller { 	public function __construct(){		parent::__construct();		$this->is_logged();		$this->check_access();	}	public function is_logged(){		if($this->session->userdata('admin_id') == ""){			redirect('erp-access');		}	}	public function check_access(){		if($this->session->userdata('admin_id') != "1"){			$access = $this->Setting_model->get_user_privilege_link();			if(!in_array($this->uri->segment(1),$access)){				$this->session->set_flashdata('message','Sorry! You dont have access to this module!');				redirect(base_url());			}		}	}	public function manage_head(){		$this->form_validation->set_rules('head_name','head name','required');		if($this->form_validation->run() === FALSE){			$data['single'] = $this->Document_model->get_single_head();			$this->load->view('admin/manage_head',$data);		}else{			$result = $this->Document_model->set_head_name();			if($result == "0"){				$this->session->set_flashdata('success','Head name added successfully');			}else{				$this->session->set_flashdata('success','Head name updated successfully');			}			redirect('manage_head');		}	}	public function manage_sub_head(){		$this->form_validation->set_rules('head_name','head name','required');		if($this->form_validation->run() === FALSE){			$data['head'] = $this->Document_model->get_all_head_name();			$data['single'] = $this->Document_model->get_single_sub_head();			$data['doc_previledge'] = $this->Document_model->get_user_document_previledges();			$this->load->view('admin/manage_sub_head',$data);		}else{			$result = $this->Document_model->set_sub_head_name();			if($result == "0"){				$this->session->set_flashdata('success','Sub Head name added successfully');			}else{				$this->session->set_flashdata('success','Sub Head name updated successfully');			}			redirect('manage_sub_head');		}	}	public function upload_documents(){		$this->form_validation->set_rules('head_name','head name','required');		if($this->form_validation->run() === FALSE){			$data['single'] = $this->Document_model->get_single_document();			$data['sub_head'] = array();			if(!empty($data['single'])){ 				$data['sub_head'] = $this->Document_model->get_active_sub_head($data['single']->head_id);			}			$data['head'] = $this->Document_model->get_active_head();			$data['doc_previledge'] = $this->Document_model->get_user_document_previledges();			$this->load->view('admin/upload_document',$data);		}else{			$photo ='';			if($_FILES['photo']['name'] !=""){				$photo = $this->Digitalocean_model->upload_photo($filename="photo",$path="uploads/");				/*$tmp = explode('.', $_FILES['photo']['name']);				$ext = end($tmp);				$config = array(					'upload_path' 	=> "uploads",					'allowed_types' => "*",					'encrypt_name'	=> TRUE,				);							$this->upload->initialize($config);				if($this->upload->do_upload('photo')){					$data = $this->upload->data();									$photo = $data['file_name'];					}else{ 					$error = array('error' => $this->upload->display_errors());						$this->upload->display_errors();				}*/			}			$result = $this->Document_model->set_documents($photo);			if($result == "0"){				$this->session->set_flashdata('success','document added successfully');			}else{				$this->session->set_flashdata('success','document updated successfully');			}			redirect('upload_documents');		}	}}