<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed'); require_once APPPATH.'vendor/autoload.php';class Consolidated_controller extends CI_Controller { 	public function __construct(){		parent::__construct();		$this->is_logged();		$this->check_access();	}	public function is_logged(){		if($this->session->userdata('admin_id') == ""){			redirect('erp-access');		}	}     public function check_access(){		if($this->session->userdata('admin_id') != "1"){			$access = $this->Setting_model->get_user_privilege_link();			if(!in_array($this->uri->segment(1),$access)){				$this->session->set_flashdata('message','Sorry! You dont have access to this module!');				redirect(base_url());			}		}	}	public function add_consolidated(){		if($this->input->post('next') == "Next"){			redirect('add_consolidated/'.$this->input->post('enrollment'));		}        $this->form_validation->set_rules('enrollment','enrollment ','required');		if($this->form_validation->run() === FALSE){			$data['student'] = $this->Consolidated_model->get_student_details();						$data['subject'] = $this->Consolidated_model->get_student_result();			 				// echo "<pre>"; print_r($data['subject']);exit();	             $this->load->view('admin/add_consolidated',$data);		}else{			$result = $this->Consolidated_model->set_consolidated_data();			if($result == "0"){				$this->session->set_flashdata('success','Result added successfull');			}else{				$this->session->set_flashdata('success','Result updated successfully');			}			redirect('add_consolidated');		}    }	public function add_other_university_subject(){		if($this->input->post('next') == "Next"){			redirect('add_consolidated/'.$this->input->post('enrollment'));		}        $this->form_validation->set_rules('enrollment','enrollment ','required');		if($this->form_validation->run() === FALSE){			$data['student'] = $this->Consolidated_model->get_student_details();						$data['subject'] = $this->Consolidated_model->get_student_result();			 			$data['added_subject'] = $this->Consolidated_model->get_credit_transfer_subject($data['student']->id);			 			$this->load->view('admin/add_other_university_subject',$data);		}else{			$userfile ='';			if($_FILES['userfile']['name'] !=""){				$userfile = $this->Digitalocean_model->upload_photo($filename="userfile",$path="images/consolidate_extra_result/"); 			}			$result = $this->Consolidated_model->set_consolidated_other_university_subject($userfile);			if($result == "0"){				$this->session->set_flashdata('success','Result added successfull');			}else{				$this->session->set_flashdata('success','Result updated successfully');			}			redirect('add_consolidated');		}    }    public function consolidated_request(){        $this->load->view('admin/consolidated_request');    }    public function consolidated_list(){        $this->load->view('admin/consolidated_list');    }    public function delete_consolidate(){		$result = $this->Consolidated_model->delete_consolidate();		$this->session->set_flashdata('success','Consolidate Marksheet deleted successfull');		redirect('consolidated_list');    }    public function edit_consolidate(){        $this->form_validation->set_rules('hidden_consolidate_id','hidden_consolidate_id ','required');		if($this->form_validation->run() === FALSE){					$data['single'] = $this->Consolidated_model->get_single_note();           $data['consolidate_details'] = $this->Consolidated_model->get_single_consolidate();		   $data['signature'] = $this->Setting_model->get_all_signature();        $this->load->view('admin/edit_consolidate',$data);		}else{			$result = $this->Consolidated_model->edit_consolidate();			if($result == "0"){				$this->session->set_flashdata('success','Result added successfull');			}			redirect('consolidated_list');		}    }	public function add_consolidated_separate_student(){		if($this->input->post('next') == "Next"){			redirect('add_consolidated_separate_student/'.$this->input->post('enrollment'));		}        $this->form_validation->set_rules('enrollment','enrollment ','required');		if($this->form_validation->run() === FALSE){			$data['student'] = $this->Consolidated_model->get_separat_student_details();						$data['subject'] = $this->Consolidated_model->get_separat_student_result();	            $this->load->view('admin/add_consolidated_separate_student',$data);		}else{			$result = $this->Consolidated_model->set_consolidated_separate_student();			if($result == "0"){				$this->session->set_flashdata('success','Result added successfull');			}			redirect('add_consolidated_separate_student');		}    }	public function consolidated_separate_request(){		$this->load->view('admin/consolidated_separate_request');	}	public function consolidated_list_separate_student(){		if($this->input->post('send_btn') == "send_btn"){			$this->Separate_student_certificate_model->sent_consolidate_certificates_for_print();			$this->session->set_flashdata("success","Certificate sent to print successfully");			redirect('consolidated_list_separate_student');		}		$this->load->view('admin/consolidated_list_separate_student');	}	public function edit_consolidate_separate_student(){		$this->form_validation->set_rules('hidden_consolidate_id','hidden_consolidate_id ','required');		if($this->form_validation->run() === FALSE){				$data['single'] = $this->Consolidated_model->get_single_note_separate_student();				$data['signature'] = $this->Separate_student_certificate_model->get_all_signature();           $data['consolidate_details'] = $this->Consolidated_model->get_single_consolidate_separate_student();        $this->load->view('admin/edit_consolidate_separate_student',$data);		}else{			$result = $this->Consolidated_model->edit_consolidate_separate_student();			if($result == "0"){				$this->session->set_flashdata('success','Result added successfull');			}			redirect('consolidated_list_separate_student');		}	}	public function consolidate_student_marksheet(){		$data['single'] = $this->Consolidated_model->get_single_marksheet_sign($this->uri->segment(2));		$data['marksheet'] = $this->Consolidated_model->get_single_markshhet($this->uri->segment(2));		$data['marksheet_id'] = $this->Consolidated_model->get_single_marksheet_id($this->uri->segment(2));		// if($data['marksheet']->enrollment_number == "201009103294863" || $data['marksheet']->enrollment_number == "201009103294946" || $data['marksheet']->enrollment_number == "201009103345002"){		// 	$this->load->view('marksheet/consolidate_student_marksheet_new',$data);		// }else{			$this->load->view('marksheet/consolidate_student_marksheet',$data);		// } 			    //$this->load->view('marksheet/consolidate_student_marksheet_new_two',$data);		/*		$html = $this->load->view('marksheet/consolidate_student_marksheet',$data,true);						$mpdf = new \Mpdf\Mpdf();		$mpdf->SetDisplayMode('fullpage');		$mpdf->defaultheaderline = 0;		 		$mpdf->WriteHTML($html);		$pdf_file_name = $data['marksheet']->id.'.pdf'; 		$file = $pdf_file_name;				$mpdf->Output($file, 'I');*/			}	public function consol_marksheet_print_separate_student(){		$data['marksheet'] = $this->Consolidated_model->get_single_markshhet_seperate_student($this->uri->segment(2));		$data['marksheet_id'] = $this->Consolidated_model->get_single_separate_marksheet_id($this->uri->segment(2));		$this->load->view('marksheet/consol_marksheet_print_separate_student',$data);	}		}