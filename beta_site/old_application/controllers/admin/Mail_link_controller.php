<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed'); class Mail_link_controller extends CI_Controller { 	public function __construct(){        parent::__construct();		$this->is_logged();		//$this->load->model('admin/Mail_link_model');		$this->load->library('form_validation');        $this->load->helper('form');			}	public function is_logged(){		if($this->session->userdata('admin_id') == ""){			redirect('erp-access');		}	}		public function check_access(){		if($this->session->userdata('admin_id') != "1"){			$access = $this->Setting_model->get_user_privilege_link();			if(!in_array($this->uri->segment(1),$access)){				$this->session->set_flashdata('message','Sorry! You dont have access to this module!');				redirect(base_url());			}		}	}	public function create_mail(){		$this->form_validation->set_rules('mail_name','mail name','required');		if($this->form_validation->run() === FALSE){			$data['single'] = $this->Mail_link_model->get_single_mail_link(); 			$this->load->view('admin/create_mail_link',$data);		}else{ 			$file_upload =''; 			$file_upload = $this->Digitalocean_model->upload_photo_multiple($filename="file_upload",$path="images/mail_file/");			 			$result = $this->Mail_link_model->set_mail_link($file_upload);			if($result == "0"){				$this->session->set_flashdata('success','Mail added successfully!');			}else{				$this->session->set_flashdata('success','Mail updateds successfully!');			}			redirect('created_mail_list');		}	}	public function create_mail_list(){		$this->load->view('admin/create_mail_list');	}	public function get_all_mail_ajax(){		$draw = intval($this->input->post("draw"));        $start = intval($this->input->post("start"));        $length = intval($this->input->post("length"));        $order = $this->input->post("order");        $search = $this->input->post("search");		$search = $search['value'];		$col = 0;        $dir = "";		if(!empty($order)){            foreach($order as $o){                $col = $o['column'];                $dir= $o['dir'];            }        }		if($dir != "asc" && $dir != "desc"){            $dir = "desc";        }				$document = $this->Mail_link_model->get_all_mail_link_ajax($length,$start,$search);        $data = array();        if(!empty($document)){			$zz=1;			foreach($document as $print){				$sub_array = array();				$sub_array[] = $zz++;				$sub_array[] = $print->name;				$sub_array[] = base_url()."read_mail/".base64_encode($print->id); 				$sub_array[] = date("d/m/Y",strtotime($print->expiry_date));				 				if($print->status == "1"){					$sub_array[] = "Active";				}else{					$sub_array[] = "Inactive";				}				if($print->status == "1"){					$sub_array[] = "<a onclick=\"return confirm('Are you sure, you want to deactivate this record?')\"' data-toggle='tooltip' title='Deactivate' href=" . base_url() . "inactive/" . $print->id . "/tbl_mail_link class='btn btn-success btn-sm inactivate_clas'><i class='mdi mdi-bookmark-check'></i></a>   									<a onclick=\"return confirm('Are you sure, you want to delete this record permanently?')\"' data-toggle='tooltip' title='Permanently Delete' href=" . base_url() . "delete/" . $print->id . "/tbl_mail_link class='btn btn-danger btn-sm delete_class'><i class='mdi mdi-delete'></i></a>									<a type='button' title='Edit' data-toggle='tooltip' href=" . base_url() . "create_mail/".$print->id."  class='btn btn-success btn-sm'><i class='mdi mdi-table-edit'></i></a>";				}else{					$sub_array[] = "<a onclick=\"return confirm('Are you sure, you want to activate this record?')\"' data-toggle='tooltip' title='Activate' href=" . base_url() . "active/" . $print->id . "/tbl_mail_link class='btn btn-danger btn-sm activate_clas'><i class='mdi mdi-playlist-remove'></i></a>									<a onclick=\"return confirm('Are you sure, you want to delete this record permanently?')\"' data-toggle='tooltip' title='Permanently Delete' href=" . base_url() . "delete/" . $print->id . "/tbl_mail_link class='btn btn-danger btn-sm delete_class'><i class='mdi mdi-delete'></i></a>									<a type='button' title='Edit' data-toggle='tooltip' href=" . base_url() . "create_mail/".$print->id."  class='btn btn-success btn-sm'><i class='mdi mdi-table-edit edit_class'></i></a>";				}								$data[] = $sub_array; 			}		}		$TotalProducts = $this->Mail_link_model->get_all_mail_link_ajax_count($search);         $output = array(            "draw" 				=> $draw,            "recordsTotal" 		=> $TotalProducts,            "recordsFiltered" 	=> $TotalProducts,            "data" 				=> $data        );        echo json_encode($output);        exit();	}}	