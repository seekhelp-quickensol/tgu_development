<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed'); class Printing_model extends CI_Model { 	public function get_printing_login(){  		$_GET = $_POST;		$this->db->where('is_deleted','0');		$this->db->where('status','1'); 		$this->db->where('email',$this->input->post('username'));		$this->db->where('password',$this->input->post('password'));		$result = $this->db->get('tbl_printer_user');		$result = $result->row(); 		echo json_encode($result);	}	public function get_printing_profile(){  		$_GET = $_POST;		$this->db->where('is_deleted','0');		$this->db->where('status','1'); 		$this->db->where('id',$this->input->post('printing_id')); 		$result = $this->db->get('tbl_printer_user');		$result = $result->row(); 		echo json_encode($result);	}	public function get_printing_marksheet(){  		$_GET = $_POST;		$this->db->select('tbl_separate_student_marksheet.*,tbl_separate_student.student_name,tbl_separate_student.enrollment_number');		$this->db->where('tbl_separate_student_marksheet.is_deleted','0');		$this->db->where('tbl_separate_student_marksheet.status','1');  		$this->db->where('tbl_separate_student_marksheet.sent_for_print','1');  		$this->db->join('tbl_separate_student','tbl_separate_student.id = tbl_separate_student_marksheet.student_id');		$result = $this->db->get('tbl_separate_student_marksheet');		$result = $result->result(); 		echo json_encode($result);	}	public function get_duplicate_printing_marksheet(){  		$_GET = $_POST;		$this->db->select('tbl_separate_student_marksheet.*,tbl_separate_student.student_name,tbl_separate_student.enrollment_number');		$this->db->where('tbl_separate_student_marksheet.is_deleted','0');		$this->db->where('tbl_separate_student_marksheet.status','1');  		$this->db->where('tbl_duplicate_marksheet_blended.sent_for_print','1');  		$this->db->join('tbl_separate_student_marksheet','tbl_separate_student_marksheet.id = tbl_duplicate_marksheet_blended.marksheet_id');		$this->db->join('tbl_separate_student','tbl_separate_student.id = tbl_duplicate_marksheet_blended.student_id');		$this->db->group_by('tbl_separate_student_marksheet.year_sem'); 		$result = $this->db->get('tbl_duplicate_marksheet_blended');		$result = $result->result(); 		echo json_encode($result);	}	public function get_print_marksheet(){		$_GET = $_POST;		$this->db->select('tbl_separate_student_marksheet.*,tbl_separate_student_exam_results.result,tbl_separate_student_exam_results.examination_month,tbl_separate_student_exam_results.examination_year,tbl_separate_student.student_name,tbl_separate_student.father_name,tbl_separate_student.mother_name,tbl_separate_student.date_of_birth,tbl_course.course_name,tbl_course.id as course_id,tbl_stream.stream_name,tbl_session.session_name,tbl_session.pre_session');		$this->db->where('tbl_separate_student_marksheet.is_deleted','0');		$this->db->where('tbl_separate_student_marksheet.status','1');		//$this->db->where('tbl_separate_student_marksheet.sent_for_print','1');		$this->db->where('tbl_separate_student_exam_results.is_deleted','0');		$this->db->where('tbl_separate_student_marksheet.id',$this->input->post('id'));		$this->db->join('tbl_separate_student_exam_results','tbl_separate_student_exam_results.id = tbl_separate_student_marksheet.result_id');		$this->db->join('tbl_separate_student','tbl_separate_student.id = tbl_separate_student_marksheet.student_id');		$this->db->join('tbl_course','tbl_course.id = tbl_separate_student.course_id');		$this->db->join('tbl_stream','tbl_stream.id = tbl_separate_student.stream_id');		$this->db->join('tbl_session','tbl_session.id = tbl_separate_student.session_id');		$result = $this->db->get('tbl_separate_student_marksheet');		$result = $result->row();		$signature = "";		if(!empty($result)){			 $signature ='<img style="width: 81px;display: block;margin: 0px auto;margin-bottom: -22px;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';			$result->ba_mark = $this->Digitalocean_model->get_photo('images/new_marksheet-background.png');			$result->footer_strip = $this->Digitalocean_model->get_photo('images/marksheet_footer_strip.png');			$courses = array(262,263,261,228,278); 			if(!empty($result) && in_array($result->course_id,$courses)){ 				$old = array(2020069063020779,2020069067071990,2020069067060985,2020069067062976);				if(in_array($result->enrollment_number,$old) && $result->year_sem == 1){					$signature = "<img style='width: 98px;display: block;margin: 0px auto;margin-bottom: -22px;' src='".$this->Digitalocean_model->get_photo('images/signature_contrroler/seprate_reg.PNG')."'>";				}else{					if($result->examination_month == "August"  && $result->examination_year =="2021"){						if(date("Y-m-d",strtotime($result->created_on)) <= '2022-02-12'){							$signature = "<img style='width: 80px;display: block;margin: 0px auto;margin-bottom: -22px;' src='".$this->Digitalocean_model->get_photo('images/signature_contrroler/SIGNATURE_OF_CONTROLLER_OF_EXAMINATIONS.png')."'>";						}else if(date("Y-m-d",strtotime($result->created_on)) >= '2022-02-19'){							$signature = '<img style="width: 95px;display: block;margin: 0px auto;margin-bottom: -22px;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';						}					}else if($result->examination_month == "June"  && $result->examination_year =="2021"){						 	$signature ='<img style="width: 81px;display: block;margin: 0px auto;margin-bottom: -22px;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';						 					}else if($result->examination_month == "January"  && $result->examination_year =="2022"){						if(date("Y-m-d",strtotime($result->created_on)) <= '2022-02-12'){							$signature ='<img style="width: 80px;display: block;margin: 0px auto;margin-bottom: -22px;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/SIGNATURE_OF_CONTROLLER_OF_EXAMINATIONS.png').'">';						}else if(date("Y-m-d",strtotime($result->created_on)) >= '2022-02-19'){							$signature ='<img style="width: 81px;display: block;margin: 0px auto;margin-bottom: -22px;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';						}					}else if($result->examination_month == "July"  && $result->examination_year =="2021"){						$signature ='<img style="width: 81px;display: block;margin: 0px auto;margin-bottom: -22px;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';					}else if($result->examination_month == "July"  && $result->examination_year =="2022"){					   $signature ='<img style="width: 81px;display: block;margin: 0px auto;margin-bottom: -22px;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';					} 				}			}else{				 $old = array(2020069063020779,2020069067071990,2020069067060985,2020069067062976);					if(in_array($result->enrollment_number,$old) && $result->year_sem == 1){						$signature ='<img style="width: 116px; display: block;margin: 0px auto;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/seprate_reg.PNG').'">';					}else{						if($result->examination_month == "August"  && $result->examination_year =="2021"){							if(date("Y-m-d",strtotime($result->created_on)) <= '2022-02-12'){								$signature ='<img style="width: 80px; display: block;margin: 0px auto;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/SIGNATURE_OF_CONTROLLER_OF_EXAMINATIONS.png').'">';							}else if(date("Y-m-d",strtotime($result->created_on)) >= '2022-02-19'){								$signature ='<img style="width: 81px; display: block;margin: 0px auto;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';							}						}else if($result->examination_month == "January"  && $result->examination_year =="2022"){							if(date("Y-m-d",strtotime($result->created_on)) <= '2022-02-12'){								$signature ='<img style="width: 80px; display: block;margin: 0px auto;"  src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/SIGNATURE_OF_CONTROLLER_OF_EXAMINATIONS.png').'">';							}else if(date("Y-m-d",strtotime($result->created_on)) >= '2022-02-19'){								$signature ='<img style="width: 81px; display: block;margin: 0px auto;"  src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';							}						}else if($result->examination_month == "July" && $result->examination_year =="2022"){            				$signature ='<img style="width: 81px;display: block;margin: 0px auto;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';						}else if($result->examination_month == "July"  && $result->examination_year =="2021"){            				    $signature ='<img style="width: 81px;display: block;margin: 0px auto;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';						}else if($result->examination_month == "January"  && $result->examination_year =="2023"){            				    $signature ='<img style="width: 81px;display: block;margin: 0px auto;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';						}					}			}			$result->auth_sign = $signature;		}						$data = array(			'sent_for_print' => '0',			'print_bucket' => '1',			'print_by' => $this->input->post('printing_id'),		);		$this->db->where('id',$this->input->post('id'));		$this->db->update('tbl_separate_student_marksheet',$data);		echo json_encode($result);	} 	public function get_print_duplicate_marksheet(){		$_GET = $_POST;		$this->db->select('tbl_separate_student_marksheet.*,tbl_separate_student_exam_results.result,tbl_separate_student_exam_results.examination_month,tbl_separate_student_exam_results.examination_year,tbl_separate_student.student_name,tbl_separate_student.father_name,tbl_separate_student.mother_name,tbl_separate_student.date_of_birth,tbl_course.course_name,tbl_course.id as course_id,tbl_stream.stream_name,tbl_session.session_name,tbl_session.pre_session');		$this->db->where('tbl_separate_student_marksheet.is_deleted','0');		$this->db->where('tbl_separate_student_marksheet.status','1');		//$this->db->where('tbl_separate_student_marksheet.sent_for_print','1');		$this->db->where('tbl_separate_student_exam_results.is_deleted','0');		$this->db->where('tbl_separate_student_marksheet.id',$this->input->post('id'));		$this->db->join('tbl_separate_student_exam_results','tbl_separate_student_exam_results.id = tbl_separate_student_marksheet.result_id');		$this->db->join('tbl_separate_student','tbl_separate_student.id = tbl_separate_student_marksheet.student_id');		$this->db->join('tbl_course','tbl_course.id = tbl_separate_student.course_id');		$this->db->join('tbl_stream','tbl_stream.id = tbl_separate_student.stream_id');		$this->db->join('tbl_session','tbl_session.id = tbl_separate_student.session_id');		$result = $this->db->get('tbl_separate_student_marksheet');		$result = $result->row();		$signature = "";		if(!empty($result)){			 $signature ='<img style="width: 81px;display: block;margin: 0px auto;margin-bottom: -22px;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';			$result->ba_mark = $this->Digitalocean_model->get_photo('images/new_marksheet-background.png');			$result->footer_strip = $this->Digitalocean_model->get_photo('images/marksheet_footer_strip.png');			$courses = array(262,263,261,228,278); 			if(!empty($result) && in_array($result->course_id,$courses)){ 				$old = array(2020069063020779,2020069067071990,2020069067060985,2020069067062976);				if(in_array($result->enrollment_number,$old) && $result->year_sem == 1){					$signature = "<img style='width: 98px;display: block;margin: 0px auto;margin-bottom: -22px;' src='".$this->Digitalocean_model->get_photo('images/signature_contrroler/seprate_reg.PNG')."'>";				}else{					if($result->examination_month == "August"  && $result->examination_year =="2021"){						if(date("Y-m-d",strtotime($result->created_on)) <= '2022-02-12'){							$signature = "<img style='width: 80px;display: block;margin: 0px auto;margin-bottom: -22px;' src='".$this->Digitalocean_model->get_photo('images/signature_contrroler/SIGNATURE_OF_CONTROLLER_OF_EXAMINATIONS.png')."'>";						}else if(date("Y-m-d",strtotime($result->created_on)) >= '2022-02-19'){							$signature = '<img style="width: 95px;display: block;margin: 0px auto;margin-bottom: -22px;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';						}					}else if($result->examination_month == "June"  && $result->examination_year =="2021"){						 	$signature ='<img style="width: 81px;display: block;margin: 0px auto;margin-bottom: -22px;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';						 					}else if($result->examination_month == "January"  && $result->examination_year =="2022"){						if(date("Y-m-d",strtotime($result->created_on)) <= '2022-02-12'){							$signature ='<img style="width: 80px;display: block;margin: 0px auto;margin-bottom: -22px;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/SIGNATURE_OF_CONTROLLER_OF_EXAMINATIONS.png').'">';						}else if(date("Y-m-d",strtotime($result->created_on)) >= '2022-02-19'){							$signature ='<img style="width: 81px;display: block;margin: 0px auto;margin-bottom: -22px;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';						}					}else if($result->examination_month == "July"  && $result->examination_year =="2021"){						$signature ='<img style="width: 81px;display: block;margin: 0px auto;margin-bottom: -22px;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';					}else if($result->examination_month == "July"  && $result->examination_year =="2022"){					   $signature ='<img style="width: 81px;display: block;margin: 0px auto;margin-bottom: -22px;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';					} 				}			}else{				 $old = array(2020069063020779,2020069067071990,2020069067060985,2020069067062976);					if(in_array($result->enrollment_number,$old) && $result->year_sem == 1){						$signature ='<img style="width: 116px; display: block;margin: 0px auto;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/seprate_reg.PNG').'">';					}else{						if($result->examination_month == "August"  && $result->examination_year =="2021"){							if(date("Y-m-d",strtotime($result->created_on)) <= '2022-02-12'){								$signature ='<img style="width: 80px; display: block;margin: 0px auto;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/SIGNATURE_OF_CONTROLLER_OF_EXAMINATIONS.png').'">';							}else if(date("Y-m-d",strtotime($result->created_on)) >= '2022-02-19'){								$signature ='<img style="width: 81px; display: block;margin: 0px auto;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';							}						}else if($result->examination_month == "January"  && $result->examination_year =="2022"){							if(date("Y-m-d",strtotime($result->created_on)) <= '2022-02-12'){								$signature ='<img style="width: 80px; display: block;margin: 0px auto;"  src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/SIGNATURE_OF_CONTROLLER_OF_EXAMINATIONS.png').'">';							}else if(date("Y-m-d",strtotime($result->created_on)) >= '2022-02-19'){								$signature ='<img style="width: 81px; display: block;margin: 0px auto;"  src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';							}						}else if($result->examination_month == "July" && $result->examination_year =="2022"){            				$signature ='<img style="width: 81px;display: block;margin: 0px auto;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';						}else if($result->examination_month == "July"  && $result->examination_year =="2021"){            				    $signature ='<img style="width: 81px;display: block;margin: 0px auto;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';						}else if($result->examination_month == "January"  && $result->examination_year =="2023"){            				    $signature ='<img style="width: 81px;display: block;margin: 0px auto;" src="'.$this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png').'">';						}					}			}			$result->auth_sign = $signature;		}						$data = array(			'sent_for_print' => '0',			'print_by' => $this->input->post('printing_id'),		);		$this->db->where('id',$this->input->post('id'));		$this->db->update('tbl_duplicate_marksheet_blended',$data);		echo json_encode($result);	} 	public function get_print_get_selected_subject_for_result(){		$_GET = $_POST;		$this->db->select('tbl_separate_student_examination_result_details.*,tbl_subject.subject_name,tbl_subject.subject_code,tbl_subject.subject_type');		$this->db->where('tbl_separate_student_examination_result_details.is_deleted','0');		$this->db->where('tbl_separate_student_examination_result_details.status','1');		$this->db->where('tbl_separate_student_examination_result_details.result_id',$this->input->post('id'));		$this->db->join('tbl_subject','tbl_subject.id = tbl_separate_student_examination_result_details.subject_id');		$this->db->order_by('tbl_subject.subject_code','ASC');		$result = $this->db->get('tbl_separate_student_examination_result_details');		echo json_encode($result->result());	}		public function get_printing_migration_certificate(){		$_GET = $_POST;		$this->db->select('tbl_separate_student_migration.*,tbl_separate_student.student_name,tbl_separate_student.enrollment_number');		$this->db->where('tbl_separate_student_migration.is_deleted','0'); 		$this->db->where('tbl_separate_student_migration.sent_for_print','1');  		$this->db->join('tbl_separate_student','tbl_separate_student.id = tbl_separate_student_migration.student_id');		$result = $this->db->get('tbl_separate_student_migration');		$result = $result->result(); 		echo json_encode($result);	}		public function get_print_migration_certificate(){		$_GET = $_POST;				$this->db->select("tbl_separate_student_migration.*,tbl_separate_student.student_name,tbl_separate_student.father_name,tbl_separate_student.enrollment_number,tbl_course.course_name,tbl_course.sort_name,tbl_session.session_start_date");		$this->db->where("tbl_separate_student_migration.is_deleted","0");		$this->db->where('tbl_separate_student_migration.sent_for_print',"1");		$this->db->where("tbl_separate_student_migration.id",$this->input->post("id"));		$this->db->join("tbl_separate_student","tbl_separate_student.id = tbl_separate_student_migration.student_id");		$this->db->join("tbl_course","tbl_course.id = tbl_separate_student.course_id"); 		$this->db->join("tbl_session","tbl_session.id = tbl_separate_student.session_id"); 		$result = $this->db->get("tbl_separate_student_migration")->row();		if(!empty($result)){ 			$result->header_logo = $this->Digitalocean_model->get_photo('images/marksheet-bg-with-logo.jpeg');			$result->logo = $this->Digitalocean_model->get_photo('images/only-logo.png');			if($result->issue_date < "2022-02-19"){ 				$result->signature = "<img style='width: 110px;' src='".$this->Digitalocean_model->get_photo('images/Deputy_Registrar.png')."'>"; 			}else{ 				$result->signature = "<img style='width: 110px' src='".$this->Digitalocean_model->get_photo('images/seprate_reg.PNG')."'>"; 			}			$result->seal = $this->Digitalocean_model->get_photo('images/btu-seal.png');		}		$data = array(			'sent_for_print' => '0'		);		$this->db->where('id',$this->input->post('id'));		$this->db->update('tbl_separate_student_migration',$data);		echo json_encode($result); 	}		public function get_printing_transfer_certificate(){		$_GET = $_POST;		$this->db->select('tbl_separate_student_transfer.*,tbl_separate_student.student_name,tbl_separate_student.enrollment_number');		$this->db->where('tbl_separate_student_transfer.is_deleted','0'); 		$this->db->where('tbl_separate_student_transfer.sent_for_print','1');  		$this->db->join('tbl_separate_student','tbl_separate_student.id = tbl_separate_student_transfer.student_id');		$result = $this->db->get('tbl_separate_student_transfer');		$result = $result->result(); 		echo json_encode($result);	}		public function get_print_transfer_certificate(){		$_GET = $_POST;		$this->db->select('tbl_separate_student_transfer.*,tbl_separate_student.student_name,tbl_separate_student.father_name,tbl_separate_student.gender,tbl_separate_student.enrollment_number,tbl_course.print_name as course_name,tbl_stream.stream_name');		$this->db->where('tbl_separate_student_transfer.is_deleted','0'); 		$this->db->where('tbl_separate_student_transfer.sent_for_print','1');  		$this->db->where('tbl_separate_student_transfer.id',$this->input->post('id'));  		$this->db->join('tbl_separate_student','tbl_separate_student.id = tbl_separate_student_transfer.student_id');		$this->db->join('tbl_course','tbl_course.id = tbl_separate_student.course_id');		$this->db->join('tbl_stream','tbl_stream.id = tbl_separate_student.stream_id');		$result = $this->db->get('tbl_separate_student_transfer');		$result = $result->row(); 		if(!empty($result)){			$result->logo = $this->Digitalocean_model->get_photo('images/new_marksheet-without.jpeg');			$result->top_logo = $this->Digitalocean_model->get_photo('images/only-logo.png');			$result->spacial_officer = $this->Digitalocean_model->get_photo('images/spacial_officer.png');		}		$data = array(			'sent_for_print' => '0'		);		$this->db->where('id',$this->input->post('id'));		$this->db->update('tbl_separate_student_transfer',$data);		echo json_encode($result);	} 	 	public function get_printing_degree_certificate(){		$_GET = $_POST;		$this->db->select('tbl_separate_student_degree.*,tbl_separate_student.student_name,tbl_separate_student.enrollment_number');		$this->db->where('tbl_separate_student_degree.is_deleted','0'); 		$this->db->where('tbl_separate_student_degree.sent_for_print','1');  		$this->db->join('tbl_separate_student','tbl_separate_student.id = tbl_separate_student_degree.student_id');		$result = $this->db->get('tbl_separate_student_degree');		$result = $result->result(); 		echo json_encode($result);	}	public function get_print_degree_certificate(){		$_GET = $_POST;		$_GET = $_POST;		$this->db->select("tbl_separate_student_degree.*,tbl_separate_student.course_id,tbl_separate_student.student_name,tbl_separate_student.father_name,tbl_separate_student.enrollment_number,tbl_session.session_start_date,tbl_course.course_name,tbl_stream.stream_name");		$this->db->where("tbl_separate_student_degree.is_deleted","0");		$this->db->where("tbl_separate_student_degree.sent_for_print","1");		$this->db->where("tbl_separate_student_degree.id",$this->input->post("id"));  		$this->db->join("tbl_separate_student","tbl_separate_student.id = tbl_separate_student_degree.student_id");		$this->db->join("tbl_session","tbl_session.id = tbl_separate_student.session_id"); 		$this->db->join("tbl_course","tbl_course.id = tbl_separate_student.course_id");		$this->db->join("tbl_stream","tbl_stream.id = tbl_separate_student.stream_id"); 		$result = $this->db->get("tbl_separate_student_degree")->row(); 		if(!empty($result)){			$result->bg_image = $this->Digitalocean_model->get_photo('images/marksheet-bg-with-logo.jpeg');			$result->degree_seal = $this->Digitalocean_model->get_photo('images/degree_seal.png');			$result->chancellor = $this->Digitalocean_model->get_photo('images/chancellor.png');						if($result->issue_date < "2022-02-19"){			$result->registrar = "<img style='width: 110px;' src='".$this->Digitalocean_model->get_photo('images/Deputy_Registrar.png')."'>";			}else{				$result->registrar = "<img style='width: 110px;' src='".$this->Digitalocean_model->get_photo('images/seprate_reg.PNG')."'>"; 			}		} 		$data = array(			'sent_for_print' => '0'		);		$this->db->where('id',$this->input->post('id'));		$this->db->update('tbl_separate_student_degree',$data);		echo json_encode($result);	}	public function get_print_division_for_degree(){		$_GET = $_POST;		if($this->input->post("course") != "23"){			$this->db->select("examination_year,internal_max_marks,internal_marks_obtained,external_max_marks,external_marks_obtained,created_on");			$this->db->where("is_deleted","0");			$this->db->where("status","1");			$this->db->where("result","0");			$this->db->where("student_id",$this->input->post("id"));			$this->db->order_by("id","DESC");			$result = $this->db->get("tbl_separate_student_exam_results")->result(); 			$total_marks = 0;			$gained_marks = 0;			foreach($result as $res){				$total_marks = $total_marks + $res->internal_max_marks + $res->external_max_marks;				$gained_marks = $gained_marks + $res->internal_marks_obtained + $res->external_marks_obtained;			}					$percentage = $total_marks == 0?0:($gained_marks/$total_marks)*100;			if($percentage >= 60){				$data["division"] = "First Division";			}else if($percentage < 60 & $percentage>= 45){				$data["division"] = "Second Division";			}else{				$data["division"] = "Third Division";			}			$data["date"] = $result[0]->examination_year;			echo json_encode($data);		}else{			 		}	}	public function get_printing_provisional_degree_certificate(){		$_GET = $_POST;		$this->db->select('tbl_separate_student_provisional_degree.*,tbl_separate_student.course_id,tbl_separate_student.student_name,tbl_separate_student.enrollment_number');		$this->db->where('tbl_separate_student_provisional_degree.is_deleted','0'); 		$this->db->where('tbl_separate_student_provisional_degree.sent_for_print','1');  		$this->db->join('tbl_separate_student','tbl_separate_student.id = tbl_separate_student_provisional_degree.student_id');		$result = $this->db->get('tbl_separate_student_provisional_degree');		$result = $result->result(); 		echo json_encode($result);	}	public function get_print_provisional_degree_certificate(){		$_GET = $_POST;  		$this->db->select("tbl_separate_student_provisional_degree.*,tbl_separate_student.course_id,tbl_separate_student.student_name,tbl_separate_student.father_name,tbl_separate_student.enrollment_number,tbl_session.session_start_date,tbl_course.course_name,tbl_stream.stream_name");		$this->db->where("tbl_separate_student_provisional_degree.is_deleted","0");		$this->db->where("tbl_separate_student_provisional_degree.payment_status","1"); 		$this->db->where("tbl_separate_student_provisional_degree.id",$this->input->post("id")); 		$this->db->join("tbl_separate_student","tbl_separate_student.id = tbl_separate_student_provisional_degree.student_id");		$this->db->join("tbl_session","tbl_session.id = tbl_separate_student.session_id"); 		$this->db->join("tbl_course","tbl_course.id = tbl_separate_student.course_id");		$this->db->join("tbl_stream","tbl_stream.id = tbl_separate_student.stream_id"); 		$result = $this->db->get("tbl_separate_student_provisional_degree");		$result = $result->row();		if(!empty($result)){ 			$result->bg_image = $this->Digitalocean_model->get_photo('images/new_marksheet-without.jpeg');			$result->top_logo = $this->Digitalocean_model->get_photo('images/only-logo.png');			$result->registrar = $this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png');			$result->seal = $this->Digitalocean_model->get_photo('images/btu-seal.png');			$result->logo = $this->Digitalocean_model->get_photo('images/logo.png');		}		$data = array(			'sent_for_print' => '0'		);		$this->db->where('id',$this->input->post('id'));		$this->db->update('tbl_separate_student_provisional_degree',$data);		echo json_encode($result);	}	public function get_printing_transcript_list(){		$_GET = $_POST;		$this->db->select('tbl_separate_transcript.*,tbl_separate_student.student_name,tbl_separate_student.enrollment_number');		$this->db->where('tbl_separate_transcript.is_deleted','0'); 		$this->db->where('tbl_separate_transcript.sent_for_print','1');  		$this->db->join('tbl_separate_student','tbl_separate_student.id = tbl_separate_transcript.registration_id');		$result = $this->db->get('tbl_separate_transcript');		$result = $result->result(); 		echo json_encode($result);	}	public function get_print_transcript_list(){		$_GET = $_POST;		$this->db->select('tbl_separate_transcript.*,tbl_separate_transcript_details.sem,tbl_separate_student.student_name,tbl_separate_student.enrollment_number,tbl_course.print_name,tbl_stream.stream_name');        $this->db->where('tbl_separate_transcript.id',$this->input->post('id'));        $this->db->where('tbl_separate_transcript.is_deleted','0');        $this->db->where('tbl_separate_transcript.status','1');		$this->db->where('tbl_separate_transcript.sent_for_print','1');         $this->db->join('tbl_separate_transcript_details','tbl_separate_transcript_details.transcript_id = tbl_separate_transcript.id');        $this->db->join('tbl_separate_student','tbl_separate_student.id = tbl_separate_transcript.registration_id');        $this->db->join('tbl_course','tbl_course.id = tbl_separate_student.course_id');        $this->db->join('tbl_stream','tbl_stream.id = tbl_separate_student.stream_id');        $this->db->group_by('tbl_separate_transcript_details.sem');		$this->db->order_by('tbl_separate_transcript_details.sem','DESC');        $result = $this->db->get('tbl_separate_transcript');        $result = $result->row();		if(!empty($result)){			$result->header_logo = $this->Digitalocean_model->get_photo('images/btu_header_image.jpg');			$result->btutrans2 = $this->Digitalocean_model->get_photo('images/btutrans2.jpg');			$result->paid_sign = $this->Digitalocean_model->get_photo('images/btu-seal.png');			if($result->issue_date < "2022-02-19"){                 $result->signature = "<img style='width: 140px' src='".$this->Digitalocean_model->get_photo('images/transtsin.png')."'>";            }else{                 $result->signature = "<img style='width: 140px' src='".$this->Digitalocean_model->get_photo('images/seprate_reg.PNG')."'>";             }					}		$data = array(			'sent_for_print' => '0'		);		$this->db->where('id',$this->input->post('id'));		$this->db->update('tbl_separate_transcript',$data);		echo json_encode($result);	}			public function get_print_get_this_transcript_total(){		$_GET = $_POST;				$this->db->select('sum(obtained) as total_obt,sum(max_mark) as total_mk');		$this->db->where('transcript_id',$this->input->post('id'));		$result = $this->db->get('tbl_separate_transcript_details');		$result = $result->row(); 		echo json_encode($result);	} 	public function get_print_this_transcript_subject(){  		$_GET = $_POST;		$this->db->where('sem',$this->input->post('sem'));		$this->db->where('transcript_id',$this->input->post('id'));		$this->db->order_by('type','DESC');		$result = $this->db->get('tbl_separate_transcript_details');		$result = $result->result();		echo json_encode($result); 	} 	public function get_print_get_print_consolidate_list(){  		$_GET = $_POST;		$this->db->select('tbl_consolidated_marksheet_separate_student.*,tbl_separate_student.student_name,tbl_separate_student.enrollment_number');		$this->db->where('tbl_consolidated_marksheet_separate_student.is_deleted','0'); 		$this->db->where('tbl_consolidated_marksheet_separate_student.sent_for_print','1');  		$this->db->join('tbl_separate_student','tbl_separate_student.enrollment_number = tbl_consolidated_marksheet_separate_student.enrollment');		$result = $this->db->get('tbl_consolidated_marksheet_separate_student');		$result = $result->result(); 		echo json_encode($result);	} 	public function get_single_print_consolidate_sep(){		$_GET = $_POST;		$this->db->select('tbl_stream.stream_name,tbl_course.course_name,tbl_consolidated_marksheet_separate_student.*,tbl_separate_student.course_id,tbl_separate_student.stream_id,tbl_separate_student.course_type,tbl_separate_student.course_mode,tbl_separate_student.year_sem,tbl_separate_student.student_name,tbl_separate_student.father_name,tbl_separate_student.mother_name');        $this->db->where('tbl_consolidated_marksheet_separate_student.is_deleted','0');        $this->db->where('tbl_consolidated_marksheet_separate_student.id',$this->input->post('id'));		$this->db->join('tbl_separate_student','tbl_separate_student.enrollment_number = tbl_consolidated_marksheet_separate_student.enrollment');		$this->db->join('tbl_course','tbl_course.id = tbl_separate_student.course_id');		$this->db->join('tbl_stream','tbl_stream.id = tbl_separate_student.stream_id');        $result = $this->db->get('tbl_consolidated_marksheet_separate_student');        $result =  $result->row();		if(!empty($result)){			$result->header_logo = $this->Digitalocean_model->get_photo('images/250-350.png');			$result->signature = $this->Digitalocean_model->get_photo('images/signature_contrroler/sahakhan.png');		}		$data = array(			'sent_for_print' => '0'		);		$this->db->where('id',$this->input->post('id'));		$this->db->update('tbl_consolidated_marksheet_separate_student',$data);		echo json_encode($result);	}	public function get_single_print_consolidate_id(){		$_GET = $_POST;		$this->db->where('is_deleted','0');        $this->db->where('id',$this->input->post('id'));        $result = $this->db->get('tbl_consolidated_marksheet_separate_student');        $result =  $result->row();		echo json_encode($result);	}	public function get_prin_selected_marksheet_course_stream_details(){		$_GET = $_POST;		$this->db->where('course',$course_id);		$this->db->where('stream',$stream_id);		$this->db->where('course_type',$course_type);		$this->db->where('course_mode',$course_mode);		$this->db->where('is_deleted','0');		$result = $this->db->get('tbl_course_stream_relation');		$result = $result->row();		echo json_encode($result);	}	public function get_prin_get_last_exam_year_separate(){		$_GET = $_POST;		$this->db->where('student_id',$this->input->post('id')); 		$this->db->order_by('year_sem','DESC');		$result = $this->db->get('tbl_separate_student_exam_results');		$result = $result->row();		echo json_encode($result);	}	public function get_prin_get_selected_subject_for_result_conso(){		$_GET = $_POST; 		$this->db->where('is_deleted','0');        $this->db->where('consolidate_id',$this->input->post('id'));		$result =  $this->db->get('tbl_consolidated_marksheet_details');        $result = $result->num_rows();		echo json_encode($result);	}	public function get_prin_get_selected_semester_subject_for_result_separate(){		$_GET = $_POST; 		$this->db->where('is_deleted','0');        $this->db->where('consolidate_id',$this->input->post('id'));        $this->db->where('year_sem',$this->input->post('sem'));        $this->db->order_by('year_sem,subject_code','ASC');       // $this->db->limit($limit,$start);        $result =  $this->db->get('tbl_consolidated_marksheet_details_separate_student');        $result = $result->result();		echo json_encode($result);	}	public function get_print_total_obt_marks_cons(){		$_GET = $_POST; 		$this->db->where('tbl_consolidated_marksheet_details.is_deleted','0');        $this->db->where('tbl_consolidated_marksheet_details.consolidate_id',$this->input->post('id'));        $this->db->where('tbl_consolidated_marksheet_details.year_sem',$this->input->post('year_sem'));        $result =  $this->db->get('tbl_consolidated_marksheet_details');        $result = $result->result(); 		$total = 0;        if(!empty($result)){			foreach($result as $result_arr){				$total += $result_arr->internal_mark+$result_arr->external_mark; 			}         }else{         }		echo json_encode($total);	}	public function get_print_total_marks_cons(){		$_GET = $_POST; 		$total = 0;		$this->db->select('SUM(tbl_consolidated_marksheet_details.total_marks) as sum_total_mark');        $this->db->where('tbl_consolidated_marksheet_details.is_deleted','0');        $this->db->where('tbl_consolidated_marksheet_details.consolidate_id',$id);        $this->db->where('tbl_consolidated_marksheet_details.year_sem',$year_sem);        $this->db->join('tbl_consolidated_marksheet','tbl_consolidated_marksheet.id = tbl_consolidated_marksheet_details.consolidate_id');        $result =  $this->db->get('tbl_consolidated_marksheet_details');        $result =$result->row();        if(!empty($result)){            $total = $result->sum_total_mark;        }else{        }		echo json_encode($total);	}
}