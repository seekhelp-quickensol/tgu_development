<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed'); class Library_model extends CI_Model {     public function set_library($ebook){        if($ebook == ""){            $ebook = $this->input->post('old_ebbok');        }        // else{        //     if(file_exists("images/ebook/".$this->input->post('old_ebbok'))){        //         unlink("images/ebook/".$this->input->post('old_ebbok'));        //     }        // }        $data = array(            'course' => $this->input->post('course'),                'stream' => $this->input->post('stream'),                'subject' => $this->input->post('subject'),                'year_sem' => $this->input->post('year_sem'),                'book_name' => $this->input->post('book_name'),                'ebook' => $ebook,             );        if($this->input->post('id') == ""){            $date = array(                    'created_on' => date("Y-m-d H:i:s")            );            $new_arr = array_merge($data,$date);            $this->db->insert('tbl_ebook_library',$new_arr);            return 0;        }else{            $this->db->where('id',$this->input->post('id'));            $this->db->update('tbl_ebook_library',$data);            return 1;         }    }    public function get_all_ebook(){        $this->db->where('is_deleted','0');        $result = $this->db->get('tbl_ebook_library');        return $result->result();    }    public function get_single_ebook(){        $this->db->where('is_deleted','0');        $this->db->where('id',$this->uri->segment(2));        $result = $this->db->get('tbl_ebook_library');        return $result->row();    }    public function get_course_stream($course){        $this->db->select('tbl_stream.stream_name,tbl_stream.id');        $this->db->where('tbl_course_stream_relation.course',$course);        $this->db->join('tbl_stream','tbl_stream.id = tbl_course_stream_relation.stream');        $result = $this->db->get('tbl_course_stream_relation');        return $result->result();    }    public function get_course_stream_subject($course,$stream,$year_sem){        $this->db->where('is_deleted','0');        $this->db->where('stream',$stream);        $this->db->where('course',$course);        $this->db->where('year_sem',$year_sem);        $result = $this->db->get('tbl_subject');        return $result->result();    }     public function get_all_e_library_ajax($length,$start,$search){		$this->db->select('tbl_ebook_library.*,tbl_subject.subject_name,tbl_course.print_name,tbl_stream.stream_name');		$this->db->where('tbl_ebook_library.is_deleted','0'); 		if($search !=""){			$this->db->group_start();			$this->db->or_like('tbl_ebook_library.book_name',$search);			$this->db->or_like('tbl_ebook_library.year_sem',$search);			$this->db->or_like('tbl_subject.subject_name',$search);			$this->db->or_like('tbl_course.print_name',$search);			$this->db->or_like('tbl_stream.stream_name',$search); 			$this->db->group_end();		}		$this->db->join('tbl_subject','tbl_subject.id = tbl_ebook_library.subject');		$this->db->join('tbl_course','tbl_course.id = tbl_ebook_library.course');		$this->db->join('tbl_stream','tbl_stream.id = tbl_ebook_library.stream'); 		$this->db->order_by('tbl_ebook_library.id','DESC'); 		$this->db->limit($length,$start);		$result = $this->db->get('tbl_ebook_library');		return $result->result();	}    public function get_all_e_library_list_ajax($length,$start,$search){		// echo "<pre>";print_r($this->input->post('course'));exit;		$this->db->select('tbl_ebook_library.*,tbl_subject.subject_name,tbl_course.print_name,tbl_stream.stream_name');		$this->db->where('tbl_ebook_library.is_deleted','0'); 	        if($this->input->post('course')!=""){			$this->db->where('tbl_ebook_library.course',$this->input->post('course'));  		}        if($this->input->post('stream') != ""){			$this->db->where('tbl_ebook_library.stream',$this->input->post('stream'));  		}        if($this->input->post('year_sem')!=""){			$this->db->where('tbl_ebook_library.year_sem',$this->input->post('year_sem'));  		}        if($this->input->post('subject')!=""){			$this->db->where('tbl_ebook_library.subject',$this->input->post('subject'));  		}		if($search !=""){			$this->db->group_start();			$this->db->or_like('tbl_ebook_library.book_name',$search);			$this->db->or_like('tbl_subject.subject_name',$search);			$this->db->or_like('tbl_stream.stream_name',$search);			$this->db->or_like('tbl_ebook_library.year_sem',$search);			$this->db->or_like('tbl_course.print_name',$search);			$this->db->group_end();		}		$this->db->join('tbl_subject','tbl_subject.id = tbl_ebook_library.subject');		$this->db->join('tbl_course','tbl_course.id = tbl_ebook_library.course');		$this->db->join('tbl_stream','tbl_stream.id = tbl_ebook_library.stream'); 		$this->db->order_by('tbl_ebook_library.id','DESC'); 		$this->db->limit($length,$start);		$result = $this->db->get('tbl_ebook_library');        return $result->result();			}    // public function get_course_stream_year_sem_subject_book_name(){	// 	$this->db->where('is_deleted','0');	// 	$this->db->where('id',$this->input->post('book_name'));	// 	$result = $this->db->get('tbl_ebook_library');	// 	echo json_encode($result->row());	// }	public function get_all_e_library_ajax_count($length,$start,$search){				$this->db->select('tbl_ebook_library.*,tbl_subject.subject_name,tbl_course.print_name,tbl_stream.stream_name');		$this->db->where('tbl_ebook_library.is_deleted','0');         if($this->input->post('course')!=""){			$this->db->where('tbl_ebook_library.course',$this->input->post('course'));  		}        if($this->input->post('stream')!=""){			$this->db->where('tbl_ebook_library.stream',$this->input->post('stream'));  		}        if($this->input->post('year_sem')!=""){			$this->db->where('tbl_ebook_library.year_sem',$this->input->post('year_sem'));  		}        if($this->input->post('subject')!=""){			$this->db->where('tbl_ebook_library.subject',$this->input->post('subject'));  		}		if($search !=""){			$this->db->group_start();	    	$this->db->or_like('tbl_ebook_library.book_name',$search);			$this->db->or_like('tbl_ebook_library.year_sem',$search);			$this->db->or_like('tbl_subject.subject_name',$search);			$this->db->or_like('tbl_course.print_name',$search);			$this->db->or_like('tbl_stream.stream_name',$search); 			$this->db->group_end();		}		$this->db->join('tbl_subject','tbl_subject.id = tbl_ebook_library.subject');		$this->db->join('tbl_course','tbl_course.id = tbl_ebook_library.course');		$this->db->join('tbl_stream','tbl_stream.id = tbl_ebook_library.stream'); 		$this->db->order_by('tbl_ebook_library.id','DESC'); 		$this->db->limit($length,$start);		$result = $this->db->get('tbl_ebook_library');		return $result->num_rows();	}    public function get_selected_course($course){        $this->db->select('tbl_course_stream_relation.*,tbl_stream.stream_name,tbl_stream.id as stream_table_id');		$this->db->where('course',$course);		$this->db->where('tbl_course_stream_relation.is_deleted','0');		$this->db->where('tbl_course_stream_relation.status','1');		$this->db->join('tbl_stream','tbl_stream.id = tbl_course_stream_relation.stream');		$result = $this->db->get('tbl_course_stream_relation');		return $result->result();		// $result = $result->result();		// echo "<pre>";print_r($result);exit;	}    public function get_selected_course_stream($course,$stream){		$this->db->where('course',$course);		$this->db->where('stream',$stream);		$this->db->where('is_deleted','0');		$this->db->where('status','1');		$result = $this->db->get('tbl_subject');		return $result->result();	}	// public function get_all_course_list_ajax($length,$start,$search){	// 	$this->db->where('is_deleted','0');	// 	$this->db->where('status','1');	// 	if($search !=""){	// 		$this->db->group_start();	//     	$this->db->or_like('tbl_course.course_name',$search);	// 		$this->db->group_end();	// 	}	// 	$this->db->order_by('tbl_course.id','DESC'); 	// 	$this->db->limit($length,$start);	// 	$result = $this->db->get('tbl_course');	// 	return $result->result();	// 	// echo "<pre>";print_r($result);exit;	// }	// public function get_all_course_list_ajax_count($length,$start,$search){	// 	$this->db->where('is_deleted','0');	// 	$this->db->where('status','1');	// 	if($search !=""){	// 		$this->db->group_start();	//     	$this->db->or_like('tbl_course.course_name',$search);	// 		$this->db->group_end();	// 	}	// 	$this->db->order_by('tbl_course.id','DESC'); 	// 	$this->db->limit($length,$start);	// 	$result = $this->db->get('tbl_course');	// 	return $result->num_rows();	// }			public function get_all_course_library_list_ajax($length,$start,$search){		$this->db->select('tbl_ebook_library.*,tbl_course.course_name');		$this->db->where('tbl_ebook_library.is_deleted','0');		// $this->db->where('tbl_ebook_library.status','1');		if($search !=""){			$this->db->group_start();	    	$this->db->or_like('tbl_course.course_name',$search);			$this->db->group_end();		}		$this->db->order_by('tbl_ebook_library.id','DESC'); 		$this->db->join('tbl_course','tbl_course.id = tbl_ebook_library.course');		$this->db->group_by('tbl_course.course_name'); 		$this->db->limit($length,$start);		$result = $this->db->get('tbl_ebook_library');		return $result->result();		// $result = $result->result();		// echo "<pre>";print_r($result);exit;	}	public function get_all_course_library_list_ajax_count($length,$start,$search){		$this->db->select('tbl_ebook_library.*,tbl_course.course_name');		$this->db->where('tbl_ebook_library.is_deleted','0');		// $this->db->where('tbl_ebook_library.status','1');		if($search !=""){			$this->db->group_start();	    	$this->db->or_like('tbl_course.course_name',$search);			$this->db->group_end();		}		$this->db->order_by('tbl_ebook_library.id','DESC'); 		$this->db->join('tbl_course','tbl_course.id = tbl_ebook_library.course');		$this->db->group_by('tbl_course.course_name'); 		$this->db->limit($length,$start);		$result = $this->db->get('tbl_ebook_library');		return $result->num_rows();	}	public function get_all_course_count_library_list_ajax($length,$start,$search){		$this->db->select('tbl_ebook_library.*,tbl_course.course_name');		$this->db->where('tbl_ebook_library.is_deleted','0');		// $this->db->where('tbl_ebook_library.status','1');		if($search !=""){			$this->db->group_start();	    	$this->db->or_like('tbl_course.course_name',$search);			$this->db->group_end();		}		$this->db->order_by('tbl_ebook_library.id','DESC'); 		$this->db->join('tbl_course','tbl_course.id = tbl_ebook_library.course');		$this->db->group_by('tbl_course.course_name'); 		$this->db->limit($length,$start);		$result = $this->db->get('tbl_ebook_library');		return $result->result();	}	public function get_all_course_count_library_list_ajax_count($length,$start,$search){		$this->db->select('tbl_ebook_library.*,tbl_course.course_name');		$this->db->where('tbl_ebook_library.is_deleted','0');		// $this->db->where('tbl_ebook_library.status','1');		if($search !=""){			$this->db->group_start();	    	$this->db->or_like('tbl_course.course_name',$search);			$this->db->group_end();		}		$this->db->order_by('tbl_ebook_library.id','DESC'); 		$this->db->join('tbl_course','tbl_course.id = tbl_ebook_library.course');		$this->db->group_by('tbl_course.course_name'); 		$this->db->limit($length,$start);		$result = $this->db->get('tbl_ebook_library');		return $result->num_rows();	}	public function get_all_stream_library_list_ajax($length,$start,$search){		$this->db->select('tbl_ebook_library.*,tbl_stream.stream_name');		$this->db->where('tbl_ebook_library.is_deleted','0');		// $this->db->where('tbl_ebook_library.status','1');		if($this->input->post('course')!=""){			$this->db->where('tbl_ebook_library.course',$this->input->post('course'));  		}		if($search !=""){			$this->db->group_start();	    	$this->db->or_like('tbl_stream.stream_name',$search);			$this->db->group_end();		}		$this->db->order_by('tbl_ebook_library.id','DESC'); 		$this->db->join('tbl_stream','tbl_stream.id = tbl_ebook_library.stream');		$this->db->group_by('tbl_stream.stream_name'); 		$this->db->limit($length,$start);		$result = $this->db->get('tbl_ebook_library');		return $result->result();		// $result = $result->result();		// echo "<pre>";print_r($result);exit;	}	public function get_all_stream_library_list_ajax_count($length,$start,$search){		$this->db->select('tbl_ebook_library.*,tbl_stream.stream_name,tbl_course.course_name');		$this->db->where('tbl_ebook_library.is_deleted','0');		// $this->db->where('tbl_ebook_library.status','1');		if($this->input->post('course')!=""){			$this->db->where('tbl_ebook_library.course',$this->input->post('course'));  		}		if($search !=""){			$this->db->group_start();	    	$this->db->or_like('tbl_stream.stream_name',$search);			$this->db->group_end();		}		$this->db->order_by('tbl_ebook_library.id','DESC'); 		$this->db->join('tbl_course','tbl_course.id = tbl_ebook_library.course');		$this->db->join('tbl_stream','tbl_stream.id = tbl_ebook_library.stream');		$this->db->group_by('tbl_stream.stream_name'); 		$this->db->limit($length,$start);		$result = $this->db->get('tbl_ebook_library');		return $result->num_rows();	}	public function get_all_year_sem_library_list_ajax($length,$start,$search){		$this->db->select('tbl_ebook_library.*,tbl_stream.stream_name,tbl_course.course_name');		$this->db->where('tbl_ebook_library.is_deleted','0');		// $this->db->where('tbl_ebook_library.status','1');		if($this->input->post('course')!=""){			$this->db->where('tbl_ebook_library.course',$this->input->post('course'));  		}		if($this->input->post('stream')!=""){			$this->db->where('tbl_ebook_library.stream',$this->input->post('stream'));  		}		if($search !=""){			$this->db->group_start();	    	$this->db->or_like('tbl_ebook_library.year_sem',$search);			$this->db->group_end();		}		$this->db->join('tbl_course','tbl_course.id = tbl_ebook_library.course');		$this->db->join('tbl_stream','tbl_stream.id = tbl_ebook_library.stream');		$this->db->order_by('tbl_ebook_library.id','DESC'); 		$this->db->group_by('tbl_ebook_library.year_sem'); 		$this->db->limit($length,$start);		$result = $this->db->get('tbl_ebook_library');		return $result->result();			}	public function get_all_year_sem_library_list_ajax_count($length,$start,$search){		$this->db->select('tbl_ebook_library.*,tbl_stream.stream_name,tbl_course.course_name');		$this->db->where('tbl_ebook_library.is_deleted','0');		// $this->db->where('tbl_ebook_library.status','1');		if($this->input->post('course')!=""){			$this->db->where('tbl_ebook_library.course',$this->input->post('course'));  		}		if($this->input->post('stream')!=""){			$this->db->where('tbl_ebook_library.stream',$this->input->post('stream'));  		}		if($search !=""){			$this->db->group_start();	    	$this->db->or_like('tbl_ebook_library.year_sem',$search);			$this->db->group_end();		}		$this->db->join('tbl_course','tbl_course.id = tbl_ebook_library.course');		$this->db->join('tbl_stream','tbl_stream.id = tbl_ebook_library.stream');		$this->db->order_by('tbl_ebook_library.id','DESC'); 		$this->db->group_by('tbl_ebook_library.year_sem'); 		$this->db->limit($length,$start);		$result = $this->db->get('tbl_ebook_library');		return $result->num_rows();	}	public function get_all_subject_library_list_ajax($length,$start,$search){		$this->db->select('tbl_ebook_library.*,tbl_subject.subject_name');		$this->db->where('tbl_ebook_library.is_deleted','0');		// $this->db->where('tbl_ebook_library.status','1');		if($this->input->post('course')!=""){			$this->db->where('tbl_ebook_library.course',$this->input->post('course'));  		}		if($this->input->post('stream')!=""){			$this->db->where('tbl_ebook_library.stream',$this->input->post('stream'));  		}		if($this->input->post('year_sem')!=""){			$this->db->where('tbl_ebook_library.year_sem',$this->input->post('year_sem'));  		}		if($search !=""){			$this->db->group_start();	    	$this->db->or_like('tbl_subject.subject_name',$search);			$this->db->group_end();		}		$this->db->order_by('tbl_ebook_library.id','DESC'); 		$this->db->join('tbl_subject','tbl_subject.id = tbl_ebook_library.subject');		$this->db->group_by('tbl_subject.subject_name'); 		$this->db->limit($length,$start);		$result = $this->db->get('tbl_ebook_library');		return $result->result();		// $result = $result->result();		// echo "<pre>";print_r($result);exit;	}	public function get_all_subject_library_list_ajax_count($length,$start,$search){		$this->db->select('tbl_ebook_library.*,tbl_subject.subject_name');		$this->db->where('tbl_ebook_library.is_deleted','0');		// $this->db->where('tbl_ebook_library.status','1');		if($this->input->post('course')!=""){			$this->db->where('tbl_ebook_library.course',$this->input->post('course'));  		}		if($this->input->post('stream')!=""){			$this->db->where('tbl_ebook_library.stream',$this->input->post('stream'));  		}		if($this->input->post('year_sem')!=""){			$this->db->where('tbl_ebook_library.year_sem',$this->input->post('year_sem'));  		}		if($search !=""){			$this->db->group_start();	    	$this->db->or_like('tbl_subject.subject_name',$search);			$this->db->group_end();		}		$this->db->order_by('tbl_ebook_library.id','DESC'); 		$this->db->join('tbl_subject','tbl_subject.id = tbl_ebook_library.subject');		$this->db->group_by('tbl_subject.subject_name'); 		$this->db->limit($length,$start);		$result = $this->db->get('tbl_ebook_library');		return $result->num_rows();	}		public function get_all_book_library_list_ajax($length,$start,$search){		$this->db->select('tbl_ebook_library.*,tbl_course.course_name');		$this->db->where('tbl_ebook_library.is_deleted','0');		// $this->db->where('tbl_ebook_library.status','1');		if($this->input->post('course')!=""){			$this->db->where('tbl_ebook_library.course',$this->input->post('course'));  		}		if($this->input->post('stream')!=""){			$this->db->where('tbl_ebook_library.stream',$this->input->post('stream'));  		}		if($this->input->post('year_sem')!=""){			$this->db->where('tbl_ebook_library.year_sem',$this->input->post('year_sem'));  		}		if($this->input->post('subject')!=""){			$this->db->where('tbl_ebook_library.subject',$this->input->post('subject'));  		}		if($search !=""){			$this->db->group_start();	    	$this->db->or_like('tbl_ebook_library.book_name',$search);			$this->db->group_end();		}		$this->db->join('tbl_course','tbl_course.id = tbl_ebook_library.course');		$this->db->order_by('tbl_ebook_library.id','DESC'); 		$this->db->limit($length,$start);		$result = $this->db->get('tbl_ebook_library');		return $result->result();	}	public function get_all_book_library_list_ajax_count($length,$start,$search){		$this->db->select('tbl_ebook_library.*,COUNT(id) as total_count');		$this->db->where('tbl_ebook_library.is_deleted','0');		// $this->db->where('tbl_ebook_library.status','1');		if($this->input->post('course')!=""){			$this->db->where('tbl_ebook_library.course',$this->input->post('course'));  		}		if($this->input->post('stream')!=""){			$this->db->where('tbl_ebook_library.stream',$this->input->post('stream'));  		}		if($this->input->post('year_sem')!=""){			$this->db->where('tbl_ebook_library.year_sem',$this->input->post('year_sem'));  		}		if($this->input->post('subject')!=""){			$this->db->where('tbl_ebook_library.subject',$this->input->post('subject'));  		}		if($search !=""){			$this->db->group_start();	    	$this->db->or_like('tbl_ebook_library.book_name',$search);			$this->db->group_end();		}		$this->db->order_by('tbl_ebook_library.id','DESC'); 		$this->db->limit($length,$start);		$result = $this->db->get('tbl_ebook_library');		// return $result->num_rows();		$result = $result->row();   		return $result->total_count;			}	// public function get_course_name($course){    //     $this->db->select('tbl_course.course_name');	// 	$this->db->where('course',$course);	// 	$this->db->where('tbl_ebook_library.is_deleted','0');	// 	$this->db->where('tbl_ebook_library.status','1');	// 	$this->db->join('tbl_course','tbl_course.id = tbl_ebook_library.course');	// 	$result = $this->db->get('tbl_ebook_library');	// 	return $result->row();	// }	// public function get_course_stream_name($course,$stream){    //     $this->db->select('tbl_course.course_name,tbl_stream.stream_name');	// 	$this->db->where('course',$course);	// 	$this->db->where('stream',$stream);	// 	$this->db->where('tbl_ebook_library.is_deleted','0');	// 	$this->db->where('tbl_ebook_library.status','1');	// 	$this->db->join('tbl_course','tbl_course.id = tbl_ebook_library.course');	// 	$this->db->join('tbl_stream','tbl_stream.id = tbl_ebook_library.stream');	// 	$result = $this->db->get('tbl_ebook_library');	// 	return $result->row();	// }	}