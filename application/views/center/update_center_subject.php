<?php include('header.php');?>    <div class="container-fluid page-body-wrapper">      <div class="main-panel">        <div class="content-wrapper">          <div class="row">            <div class="col-md-12 grid-margin stretch-card">              <div class="card">                <div class="card-body">                                    <h4 class="card-title">Update Subject <a href="<?=base_url();?>my_list_subject" class="btn btn-primary mr-2 float-right">View List</a></h4><p class="card-description">                    Please enter Subject details                  </p>                  <form class="forms-sample" name="relation_form" id="relation_form" method="post" enctype="multipart/form-data">					<input type="hidden" class="form-control" id="id" name="id" value="<?php if(!empty($single)){ echo $single->id;}?>">                    <div class="row">						<div class="col-md-6">							<div class="form-group">							  <label for="exampleInputUsername1">Course Name *</label>							  <select class="form-control js-example-basic-single exist_fees course_list" id="course" name="course" disabled>								<option value="">Select Course</option>								<?php if(!empty($course)){ foreach($course as $course_result){?>								<option value="<?=$course_result->course?>" <?php if(!empty($single) && $single->course == $course_result->course){?>selected<?php }?>><?=$course_result->course_name?></option>								<?php }}?>							  </select>							  <input type="hidden" name="course_id" id="course_id" class="form-control" value="<?php if(!empty($single)){ echo $single->course;}?>"/>							  <div class="error" id="relation_error"></div>							</div>						</div>												<?php 						    $stream = [];						    if(!empty($single)){						         $stream = $this->Center_details_model->get_selected_course_streams($single->course);						        						    }						?>						<div class="col-md-6">						<div class="form-group">						  <label for="exampleInputUsername1">Stream Name *</label>						  <select class="form-control js-example-basic-single exist_fees course_list" id="stream" name="stream" disabled>							<option value="">Select Stream</option>							<?php if(!empty($stream)){ foreach($stream as $stream_result){?>							<option value="<?=$stream_result->id.'@@@'.$stream_result->stream;?>" <?php if(!empty($single) && $single->stream == $stream_result->stream){?>selected="selected"<?php }?>><?=$stream_result->stream_name?></option>							<?php }}?>						  </select>						</div>					</div>					</div>					 <div class="row">					       <?php 					            $mode = [];					            if(!empty($single)){    						         $mode = $this->Center_details_model->get_selected_course_stream_mode($single->course,$single->stream);    						            						    }					       ?>						<div class="col-md-6">							<div class="form-group">							  <label for="exampleInputUsername1">Course Mode *</label>							  <select class="form-control js-example-basic-single" id="course_mode" name="course_mode" disabled>								<option value="">Select Mode</option>																<?php 								    if (!empty($mode)) {                        				if ($mode->course_mode == "3") {                        		?>	            						<option value=''>Select Course Mode</option>            						<option value='1' <?php if(!empty($single) && $single->mode == '1'){?>selected<?php }?>>Year</option>            						<option value='2' <?php if(!empty($single) && $single->mode == '2'){?>selected<?php }?>>Semester</option>            						<option value='3' <?php if(!empty($single) && $single->mode == '3'){?>selected<?php }?>>Both</option>                        				                        		<?php } else if ($mode->course_mode == "2") {?>                        				            						<option value=''>Select Course Mode</option>            						<option value='2' <?php if(!empty($single) && $single->mode == '2'){?>selected<?php }?>>Semester</option>            						<option value='3' <?php if(!empty($single) && $single->mode == '3'){?>selected<?php }?>>Both</option>                        			                        		<?php } else if ($mode->course_mode == "1") {?>            						<option value=''>Select Course Mode</option>            						<option value='1' <?php if(!empty($single) && $single->mode == '1'){?>selected<?php }?>>Year</option>                        		<?php } else if ($mode->course_mode == "4") {?>            						<option value=''>Select Course Mode</option>            						<option value='4' <?php if(!empty($single) && $single->mode == '4'){?>selected<?php }?>>Month</option>                        				                        		<?php }}?>							  </select>							</div>						</div>						<div class="col-md-6">							<div class="form-group">							  <label for="exampleInputUsername1">Year/Sem *</label>							  <select class="form-control js-example-basic-single" id="year_sem" name="year_sem" disabled>								<option value="">Select</option>								<?php for($y=1;$y<=12;$y++){?>								<option value="<?=$y?>" <?php if(!empty($single) && $single->year_sem == $y){?>selected<?php }?>><?=$y?></option>								<?php }?>							  </select>							</div>						</div>					</div>										 <div class="row">						<div class="col-md-12">							 <table class="resultTable">								<tr><td class="heading">Subject Code</td>									<td  class="heading">Subject Name</td>									<td  class="heading">Subject Type</td>									<td  class="heading">Internal Marks</td>									<td  class="heading">External Marks</td>									<td  class="heading">Credits</td>								</tr>  								<?php								    $subjects = [];								    if(!empty($single)){        						         $subjects = $this->Center_details_model->get_selected_course_stream_subject($single->course,$single->stream,$single->mode,$single->year_sem);        						    }        						                                      if(!empty($subjects)){ $i=1; foreach($subjects as $subject_result){								?>                      									<tr>   									    <td>									        <input type="text" name="txtSubjectCode[]" id="txtSubjectCode<?php echo $i ?>" class="form-control" maxlength="20" value="<?=$subject_result->subject_code;?>" readonly>									        <input type="hidden" name="hidden_id[]" id="hidden_id<?php echo $i ?>" class="form-control" value="<?=$subject_result->id;?>"/>									    </td>										<td><input type="text" name="txtSubjectName[]" id="txtSubjectName<?php echo $i ?>" class="form-control" maxlength="254" value="<?=$subject_result->subject_name;?>" readonly></td>										<td>											<select name="comboType[]" id="comboType<?php echo $i ?>" class="form-control" disabled>												<option value="0" <?php if($subject_result->subject_type == '0'){?>selected<?php }?>>Theory</option>												<option value="1" <?php if($subject_result->subject_type == '1'){?>selected<?php }?>>Practical</option>                            											</select>										</td>                    										<td><input type="text" name="txtIMM[]" id="txtIMM<?php echo $i ?>" class="form-control" maxlength="4" value="<?=$subject_result->internal_marks;?>" onkeypress="return isNumber(event)" readonly /></td>										<td><input type="text" name="txtEMM[]" id="txtEMM<?php echo $i ?>" class="form-control" maxlength="4" value="<?=$subject_result->external_mark;?>" onkeypress="return isNumber(event)" readonly /></td>										<td><input type="text" name="txtCredit[]" id="txtCredit<?php echo $i ?>" value="<?=$subject_result->credit;?>" <?php if($this->session->userdata('center_id') != '1' && $this->session->userdata('center_id') != '12'){?>readonly<?php }?> class="form-control" maxlength="2" onkeypress="return isNumber(event)" oninput="checkValue(this)"  /></td>									</tr>								<?php $i++; }} ?>							</table>						</div>					</div>					                    <button type="submit" id="save_btn" class="btn btn-primary mr-2">Submit</button>                                      </form>                </div>              </div>            </div>                      </div>        </div>      <?php include('footer.php');$id = 0;if($this->uri->segment(2) !=""){	$id = $this->uri->segment(2);}?> <script> $(document).ready(function () {			jQuery.validator.addMethod("validate_email", function(value, element) {		if (/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/.test(value)) {			return true;		}else {			return false;		}	}, "Please enter a valid Email.");		$('#relation_form').validate({		rules: {			course: {				required: true,			},			stream: {				required: true,			},			course_mode: {				required: true,			},			year_sem: {				required: true,			},		},		messages: {			course: {				required: "Please select course",			},			stream: {				required: "Please select stream",			},			course_mode: {				required: "Please select course mode",			},			year_sem: {				required: "Please select year/sem",			},		},		errorElement: 'span',		errorPlacement: function (error, element) {			error.addClass('invalid-feedback');			element.closest('.form-group').append(error);		},		highlight: function (element, errorClass, validClass) {			$(element).addClass('is-invalid');		},		unhighlight: function (element, errorClass, validClass) {			$(element).removeClass('is-invalid');		},		submitHandler: function(form) {			if(checkSubject()==false){				return false;			}else{				form.submit();			}		}	});});$(".fees_add").change(function(){  	$.ajax({		type: "POST",		url: "<?=base_url();?>admin/Ajax_controller/get_unique_course_stream_fees",		data:{'course':$("#course").val(),'stream':$("#stream").val(),'session':$("#session").val(),'id':'<?=$id?>'},		success: function(data){			if(data == "0"){				$("#relation_error").html("");				$("#save_btn").show();			}else{				$("#relation_error").html("This relation is already added");				$("#save_btn").hide();			}		},		 error: function(jqXHR, textStatus, errorThrown) {		   console.log(textStatus, errorThrown);		}	});	});$("#course").change(function(){  	$.ajax({		type: "POST",		url: "<?=base_url();?>admin/Ajax_controller/get_course_stream_ajax",		data:{'course':$("#course").val()},		success: function(data){			$("#stream").empty();			$('#stream').append('<option value="">Select Stream</option>');			var opts = $.parseJSON(data);			$.each(opts, function(i, d) {			   $('#stream').append('<option value="' + d.id + '@@@' + d.stream + '">' + d.stream_name + '</option>');			});			$('#stream').trigger('change');			},		 error: function(jqXHR, textStatus, errorThrown) {		   console.log(textStatus, errorThrown);		}	});	});$(".exist_fees").change(function(){  	$.ajax({		type: "POST",		url: "<?=base_url();?>admin/Ajax_controller/get_course_stream_mode",		data:{'course':$("#course").val(),'stream':$("#stream").val()},		success: function(data){			$("#course_mode").empty();			$("#course_mode").html(data);			$('#course_mode').trigger('change');		},		 error: function(jqXHR, textStatus, errorThrown) {		   console.log(textStatus, errorThrown);		}	});	});function checkSubject(){	var valid=true;	if (document.getElementById("txtSubjectCode1").value.length==0 || document.getElementById("txtSubjectName1").value.length==0 || document.getElementById("txtIMM1").value.length==0 || document.getElementById("txtEMM1").value.length==0 || document.getElementById("txtCredit1").value.length==0)	{		alert ("Please fill all fields for subject 1");		valid=false;	}   for(i=2;i<=10;i++){		if (document.getElementById("txtSubjectCode" + i).value.length!=0 || document.getElementById("txtSubjectName" + i).value.length!=0 || document.getElementById("txtIMM" + i).value.length!=0 || document.getElementById("txtEMM" + i).value.length!=0 || document.getElementById("txtCredit" + i).value.length!=0)			if (document.getElementById("txtSubjectCode" + i).value.length==0 || document.getElementById("txtSubjectName" + i).value.length==0 || document.getElementById("txtIMM" + i).value.length==0 || document.getElementById("txtEMM" + i).value.length==0 || document.getElementById("txtCredit" + i).value.length==0)			{				alert ("Please fill all fields for subject " + i);				valid=false;				break;			}   	}	return valid;}function checkValue(input) {	<?php if($this->session->userdata('center_id') != '1' && $this->session->userdata('center_id') != '12'){?>		if (input.value > 4) {			alert("Credits cannot be greater than 4!");			input.value = "";		}	<?php }?>}</script> 