<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed'); class Faculty_controller extends CI_Controller { 	public function __construct(){		parent::__construct();		$this->is_logged();		//$this->check_access();	}	public function is_logged(){		if($this->session->userdata('admin_id') == ""){			redirect('erp-access');		}	}	public function check_access(){		$access = $this->Setting_model->get_user_privilege_link();		if(!in_array($this->uri->segment(1),$access)){			//$this->session->set_flashdata('message','Sorry! You dont have access to this module!');			//redirect(base_url());		}	}	public function staff_faculty(){		$this->load->view('admin/staff_faculty');	}	public function left_staff_faculty(){		$this->load->view('admin/left_staff_faculty');	}	public function faculty_left(){		$this->Faculty_model->faculty_left();		$this->session->set_flashdata('success','Faculty Updated successfully!');		redirect($_SERVER['HTTP_REFERER']);	}		public function faculty_not_left(){		$this->Faculty_model->faculty_not_left();		$this->session->set_flashdata('success','Faculty Updated successfully!');		redirect($_SERVER['HTTP_REFERER']);	}	public function add_staff_faculty(){		$this->form_validation->set_rules('first_name','first name','required');		if($this->form_validation->run() === FALSE){			$data['single'] = $this->Faculty_model->get_single_faculty_staff();			$data['document'] = $this->Faculty_model->get_faculty_document();			$this->load->view('admin/add_staff_faculty',$data);		}else{			$image ='';			if(isset($_FILES['userfile']) && $_FILES['userfile']['name'] != ""){				$image = $this->Digitalocean_model->upload_photo($filename="userfile",$path="images/faculty_staff/photo/");    			/*$config = array(    				'upload_path' 	=> "images/faculty_staff/photo",    				'allowed_types' => "*",    				'encrypt_name'	=> true,    			);			    			$this->upload->initialize($config);    			if($this->upload->do_upload('userfile')){    				$data = $this->upload->data();				    				$image = $data['file_name'];    					    			}else{    				$error = array('error' => $this->upload->display_errors());	    				$this->upload->display_errors();    			}*/			}			$adhacard ='';			if(isset($_FILES['userfile1']) && $_FILES['userfile1']['name'] != ""){				$adhacard = $this->Digitalocean_model->upload_photo($filename="userfile1",$path="images/faculty_staff/document/");    			/*$config = array(    				'upload_path' 	=> "images/faculty_staff/document",    				'allowed_types' => "*",    				'encrypt_name'	=> true,    			);			    			$this->upload->initialize($config);    			if($this->upload->do_upload('userfile1')){    				$data = $this->upload->data();				    				$adhacard = $data['file_name'];    					    			}else{    				$error = array('error' => $this->upload->display_errors());	    				$this->upload->display_errors();    			}*/			} 			$cv_documents ='';			if(isset($_FILES['userfile2']) && $_FILES['userfile2']['name'] != ""){				$cv_documents = $this->Digitalocean_model->upload_photo($filename="userfile2",$path="images/faculty_staff/cv/");    			/*$config = array(    				'upload_path' 	=> "images/faculty_staff/cv",    				'allowed_types' => "*",    				'encrypt_name'	=> true,    			);			    			$this->upload->initialize($config);    			if($this->upload->do_upload('userfile2')){    				$data = $this->upload->data();				    				$cv_documents = $data['file_name'];    					    			}else{    				$error = array('error' => $this->upload->display_errors());	    				$this->upload->display_errors();    			}*/			}  			$eligible_documents ='';			if(isset($_FILES['userfile3']) && $_FILES['userfile3']['name'] != ""){				$eligible_documents = $this->Digitalocean_model->upload_photo($filename="userfile3",$path="images/faculty_staff/ed/");    			/*$config = array(    				'upload_path' 	=> "images/faculty_staff/ed",    				'allowed_types' => "*",    				'encrypt_name'	=> true,    			);			    			$this->upload->initialize($config);    			if($this->upload->do_upload('userfile3')){    				$data = $this->upload->data();				    				$eligible_documents = $data['file_name'];    					    			}else{    				$error = array('error' => $this->upload->display_errors());	    				$this->upload->display_errors();    			}*/			}   			$result = $this->Faculty_model->set_staff_faculty($image,$adhacard,$cv_documents,$eligible_documents);			if($result == "0"){				$this->session->set_flashdata('success','Faculty added successfully!');			}else{ 				$this->session->set_flashdata('success','Faculty updated successfully!');			}			redirect('staff_faculty');		}	}	public function today_staff_faculty(){		if($this->input->post('save_btn') == 'reply_submit'){			$this->Faculty_model->set_faculty_report_reply();			$this->session->set_flashdata('success','Reply added successfully!');			redirect('today_staff_faculty');		}		$this->load->view('admin/today_staff_faculty');	}	public function all_staff_faculty(){		if($this->input->post('save_btn') == 'reply_submit'){			$this->Faculty_model->set_faculty_report_reply();			$this->session->set_flashdata('success','Reply added successfully!');			redirect('all_staff_faculty');		}		$this->load->view('admin/all_staff_faculty');	}	public function feedback_list(){		$this->load->view('admin/feedback_list');	}		public function admin_view_register(){		$this->load->view('admin/admin_view_register');	}		public function admin_view_attendance(){		$data['register'] = $this->Faculty_model->get_single_register_details(); 		$data['student'] = array();		if(!empty($data['register'])){			$data['student'] = $this->Faculty_model->get_single_register_student_details($data['register']->id); 		// echo "<pre>";print_r($data['student']);exit;		} 		$data['single'] = $this->Faculty_model->get_single_student_attendance_admin();		// echo "<pre>";print_r($data['single']);exit;		$this->load->view('admin/admin_view_attendance',$data);	}	public function waiting_list_for_report(){		$data['faculty'] = $this->Faculty_model->get_all_waiting_report_list();		$this->load->view('admin/waiting_list_for_report',$data);	}	public function send_report_reminder(){		$this->Faculty_model->send_report_reminder();		$this->session->set_flashdata('success','Reminder sent successfully!');		redirect($_SERVER['HTTP_REFERER']);	}	public function admin_faculty_documents(){ 		$this->form_validation->set_rules('head','document name','required');		if($this->form_validation->run() === FALSE){			$data['staff'] = $this->Faculty_model->get_single_staff_faculty();			$this->load->view('admin/admin_faculty_documents',$data);		}else{			$file ='';			if($_FILES['userfile']['name'] !=""){				$file = $this->Digitalocean_model->upload_photo($filename="userfile",$path="uploads/faculty_documents/");				/*$tmp = explode('.', $_FILES['userfile']['name']);				$ext = end($tmp);				$config = array(					'upload_path' 	=> "uploads/faculty_documents",					'allowed_types' => "*",					'encrypt_name'	=> TRUE,				);							$this->upload->initialize($config);				if($this->upload->do_upload('userfile')){					$data = $this->upload->data();									$file = $data['file_name'];					}else{ 					$error = array('error' => $this->upload->display_errors());						$this->upload->display_errors();				}*/			}			$result = $this->Faculty_model->set_admin_faculty_documents($file);			if($result == "0"){				$this->session->set_flashdata('success','Document added successfully');			}else{				$this->session->set_flashdata('success','Document updated successfully');			}			redirect($_SERVER['HTTP_REFERER']);		}	}	public function bulk_attendance_list(){		$this->load->view('admin/bulk_attendance_list');	}	public function admin_staff_attendance(){		$data['staff'] = $this->Faculty_model->get_staff_attebdance();		$this->load->view('admin/admin_staff_attendance',$data);	}	public function all_online_classes(){		$this->load->view('admin/all_online_classes');	}	public function faculty_staff_list(){		$this->load->view("admin/faculty_staff_list");	}	public function delete_faculty_document(){		$this->Faculty_model->delete_faculty_document();		$this->session->set_flashdata('success', 'Record deleted successfully');		redirect($_SERVER['HTTP_REFERER']);	}	public function delete_faculty_document_image(){		$this->Faculty_model->delete_faculty_document_image();		$this->session->set_flashdata('success', 'Record deleted successfully');		redirect($_SERVER['HTTP_REFERER']);	}	public function delete_faculty_cv_document(){		$this->Faculty_model->delete_faculty_cv_document();		$this->session->set_flashdata('success', 'Record deleted successfully');		redirect($_SERVER['HTTP_REFERER']);	}	public function delete_faculty_eligible_document(){		$this->Faculty_model->delete_faculty_eligible_document();		$this->session->set_flashdata('success', 'Record deleted successfully');		redirect($_SERVER['HTTP_REFERER']);	}}